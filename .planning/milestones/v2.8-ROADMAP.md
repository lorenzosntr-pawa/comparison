# Milestone v2.8: Storage Optimization

**Status:** ✅ SHIPPED 2026-02-17
**Phases:** 100-104
**Total Plans:** 7

## Overview

Reduce database from 63 GB to under 15 GB through raw_response column removal and 7-day retention cleanup, achieving 81% reduction with Storage dashboard for ongoing monitoring.

## Phases

### Phase 100: Investigation & Analysis

**Goal**: Profile all tables to measure sizes and growth patterns, identify growth drivers, design optimized schema strategy
**Depends on**: v2.7 Availability Tracking Bugfix complete
**Plans**: 1/1 complete

Plans:
- [x] 100-01: Database profiling and storage analysis (2026-02-17)

**Key Findings:**
- Database: 63 GB (3x larger than expected)
- Primary driver: raw_response columns (33 GB, 53%)
- raw_response is UNUSED after scraping completes
- Recommended: Remove raw_response + 7-day retention = 78% reduction

### Phase 101: Schema Implementation

**Goal**: Remove raw_response columns from snapshot tables to reclaim 33 GB (53% of database)
**Depends on**: Phase 100
**Plans**: 1/1 complete

Plans:
- [x] 101-01: Remove raw_response columns from models, DTOs, scraping code, and database (2026-02-17)

### Phase 102: Scraping Verification & Testing

**Goal**: Verify scraping still works correctly after raw_response removal, run end-to-end validation
**Depends on**: Phase 101
**Plans**: 1/1 complete

Plans:
- [x] 102-01: Scraping verification (2026-02-17)

### Phase 103: Data Migration & Validation

**Goal**: Reclaim disk space from dropped columns and apply 7-day retention
**Depends on**: Phase 102
**Plans**: 1/1 complete

Plans:
- [x] 103-01: Space reclamation and retention cleanup (2026-02-17)

**Results:**
- Database: 63.25 GB → 11.94 GB (81% reduction)
- VACUUM FULL reclaimed ~35 GB from dropped raw_response columns
- 7-day retention deleted 60M+ market_odds records

### Phase 104: Monitoring & Prevention

**Goal**: Add database size tracking dashboard, implement automated retention policies, set up alerts for abnormal growth
**Depends on**: Phase 103
**Plans**: 3/3 complete

Plans:
- [x] 104-01: Storage size API & history tracking (backend) — 2026-02-17
- [x] 104-02: Storage dashboard (frontend) — 2026-02-17
- [x] 104-03: Growth alerting (full-stack) — 2026-02-17

---

## Milestone Summary

**Key Decisions:**
- raw_response columns are UNUSED after scraping — safe to remove
- Combined optimization strategy: raw_response removal + 7-day retention for maximum impact
- VACUUM FULL required after column drop to actually reclaim disk space
- Hold raw API data in memory during scrape only, don't persist to database

**Issues Resolved:**
- Database growth unsustainable at 63 GB
- Unused data consuming 53% of storage

**Issues Deferred:**
- Market-level change detection for further reduction (addressed in v2.9)

**Technical Debt Incurred:**
- None

---

_For current project status, see .planning/ROADMAP.md_
