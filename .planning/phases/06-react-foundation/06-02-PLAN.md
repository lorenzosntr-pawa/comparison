---
phase: 06-react-foundation
plan: 02
type: execute
---

<objective>
Set up Tailwind CSS v4 with shadcn/ui and dark/light theme support.

Purpose: Establish the styling foundation and component library that all UI features use.
Output: Working Tailwind + shadcn setup with theme toggle, base components available.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-react-foundation/06-RESEARCH.md
@.planning/phases/06-react-foundation/06-CONTEXT.md
@.planning/phases/06-react-foundation/06-01-SUMMARY.md

**Key research findings:**
- Tailwind v4 uses CSS-based config, NOT tailwind.config.js
- shadcn/ui CLI may have Windows issues - use WSL or manual copy if needed
- ThemeProvider pattern for dark/light mode with localStorage persistence
- Use @tailwindcss/vite plugin for Tailwind v4

**From 06-CONTEXT.md:**
- Support dark and light themes with toggle
- Bloomberg terminal feel - data-dense but readable
- Professional trading terminal aesthetic
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install and configure Tailwind CSS v4</name>
  <files>web/package.json, web/vite.config.ts, web/src/index.css</files>
  <action>
1. Install Tailwind v4 and Vite plugin:
   `pnpm install -D tailwindcss@latest @tailwindcss/vite@latest`

2. Update vite.config.ts to add Tailwind plugin:
```typescript
import path from "path"
import tailwindcss from "@tailwindcss/vite"
import react from "@vitejs/plugin-react"
import { defineConfig } from "vite"

export default defineConfig({
  plugins: [react(), tailwindcss()],
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./src"),
    },
  },
  server: {
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true,
      },
    },
  },
})
```

3. Update src/index.css with Tailwind v4 import:
```css
@import "tailwindcss";
```

4. Test Tailwind works by adding a class in App.tsx:
```typescript
<h1 className="text-2xl font-bold text-blue-600">Betpawa Odds Comparison</h1>
```
  </action>
  <verify>pnpm run dev shows styled heading, Tailwind classes apply correctly</verify>
  <done>Tailwind v4 working with Vite, utility classes render correctly</done>
</task>

<task type="auto">
  <name>Task 2: Initialize shadcn/ui and add base components</name>
  <files>web/components.json, web/src/components/ui/*, web/src/index.css</files>
  <action>
1. Initialize shadcn (will create components.json):
   `npx shadcn@latest init`

   When prompted:
   - Style: Default
   - Base color: Neutral
   - CSS variables: yes
   - components.json location: (default)
   - Import alias for components: @/components
   - Import alias for utils: @/lib/utils

   If Windows issues occur, manually create components.json:
```json
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "default",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "",
    "css": "src/index.css",
    "baseColor": "neutral",
    "cssVariables": true
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "iconLibrary": "lucide"
}
```

2. Add essential base components:
   `npx shadcn@latest add button card badge skeleton`

   If CLI fails, manually copy from ui.shadcn.com - each component is a single file.

3. Install lucide-react for icons:
   `pnpm install lucide-react`

4. Verify components work by using Button in App.tsx:
```typescript
import { Button } from '@/components/ui/button'

// In render:
<Button variant="outline">Test Button</Button>
```
  </action>
  <verify>pnpm run dev shows styled Button, Card, Badge, Skeleton components render</verify>
  <done>shadcn/ui initialized, base components (button, card, badge, skeleton) available</done>
</task>

<task type="auto">
  <name>Task 3: Create ThemeProvider with dark/light mode</name>
  <files>web/src/components/theme-provider.tsx, web/src/components/mode-toggle.tsx, web/src/App.tsx, web/index.html</files>
  <action>
1. Add dropdown-menu component for mode toggle:
   `npx shadcn@latest add dropdown-menu`

2. Create src/components/theme-provider.tsx:
```typescript
import { createContext, useContext, useEffect, useState } from 'react'

type Theme = 'dark' | 'light' | 'system'

type ThemeProviderProps = {
  children: React.ReactNode
  defaultTheme?: Theme
  storageKey?: string
}

type ThemeProviderState = {
  theme: Theme
  setTheme: (theme: Theme) => void
}

const initialState: ThemeProviderState = {
  theme: 'system',
  setTheme: () => null,
}

const ThemeProviderContext = createContext<ThemeProviderState>(initialState)

export function ThemeProvider({
  children,
  defaultTheme = 'system',
  storageKey = 'betpawa-ui-theme',
  ...props
}: ThemeProviderProps) {
  const [theme, setTheme] = useState<Theme>(
    () => (localStorage.getItem(storageKey) as Theme) || defaultTheme
  )

  useEffect(() => {
    const root = window.document.documentElement
    root.classList.remove('light', 'dark')

    if (theme === 'system') {
      const systemTheme = window.matchMedia('(prefers-color-scheme: dark)')
        .matches
        ? 'dark'
        : 'light'
      root.classList.add(systemTheme)
      return
    }

    root.classList.add(theme)
  }, [theme])

  const value = {
    theme,
    setTheme: (theme: Theme) => {
      localStorage.setItem(storageKey, theme)
      setTheme(theme)
    },
  }

  return (
    <ThemeProviderContext.Provider {...props} value={value}>
      {children}
    </ThemeProviderContext.Provider>
  )
}

export const useTheme = () => {
  const context = useContext(ThemeProviderContext)
  if (context === undefined)
    throw new Error('useTheme must be used within a ThemeProvider')
  return context
}
```

3. Create src/components/mode-toggle.tsx:
```typescript
import { Moon, Sun } from 'lucide-react'
import { Button } from '@/components/ui/button'
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu'
import { useTheme } from '@/components/theme-provider'

export function ModeToggle() {
  const { setTheme } = useTheme()

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="outline" size="icon">
          <Sun className="h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0" />
          <Moon className="absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100" />
          <span className="sr-only">Toggle theme</span>
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end">
        <DropdownMenuItem onClick={() => setTheme('light')}>
          Light
        </DropdownMenuItem>
        <DropdownMenuItem onClick={() => setTheme('dark')}>
          Dark
        </DropdownMenuItem>
        <DropdownMenuItem onClick={() => setTheme('system')}>
          System
        </DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  )
}
```

4. Add theme flash prevention script to index.html (before </head>):
```html
<script>
  (function() {
    const theme = localStorage.getItem('betpawa-ui-theme') || 'system';
    const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const isDark = theme === 'dark' || (theme === 'system' && systemDark);
    document.documentElement.classList.add(isDark ? 'dark' : 'light');
  })();
</script>
```

5. Update App.tsx to use ThemeProvider:
```typescript
import { QueryClient, QueryClientProvider } from '@tanstack/react-query'
import { ReactQueryDevtools } from '@tanstack/react-query-devtools'
import { ThemeProvider } from '@/components/theme-provider'
import { ModeToggle } from '@/components/mode-toggle'
import { Button } from '@/components/ui/button'

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 1000 * 60 * 5,
      gcTime: 1000 * 60 * 10,
      retry: 1,
      refetchOnWindowFocus: false,
    },
  },
})

export default function App() {
  return (
    <QueryClientProvider client={queryClient}>
      <ThemeProvider defaultTheme="system" storageKey="betpawa-ui-theme">
        <div className="min-h-screen bg-background text-foreground">
          <div className="p-4 flex justify-between items-center">
            <h1 className="text-2xl font-bold">Betpawa Odds Comparison</h1>
            <ModeToggle />
          </div>
          <div className="p-4">
            <Button>Test Button</Button>
          </div>
        </div>
      </ThemeProvider>
      <ReactQueryDevtools initialIsOpen={false} />
    </QueryClientProvider>
  )
}
```
  </action>
  <verify>Theme toggle works (dropdown appears), switching between light/dark/system works, preference persists after refresh, no flash on page load</verify>
  <done>ThemeProvider with localStorage persistence, ModeToggle dropdown, no theme flash on load</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pnpm run dev` renders styled components
- [ ] `pnpm run build` succeeds without errors
- [ ] Tailwind utilities work (text-*, bg-*, etc.)
- [ ] shadcn Button, Card, Badge, Skeleton components import correctly
- [ ] Theme toggle switches between light/dark/system
- [ ] Theme preference persists after page refresh
- [ ] No white flash when loading dark theme
</verification>

<success_criteria>

- Tailwind v4 configured and working with Vite
- shadcn/ui initialized with base components
- ThemeProvider enables dark/light/system modes
- ModeToggle provides user control
- No theme flash on page load
- All components render correctly in both themes
</success_criteria>

<output>
After completion, create `.planning/phases/06-react-foundation/06-02-SUMMARY.md`:

# Phase 6 Plan 02: UI Foundation Summary

**[Substantive summary of what was accomplished]**

## Accomplishments
- [Key outcomes]

## Files Created/Modified
- `web/vite.config.ts` - Added Tailwind plugin
- `web/components.json` - shadcn configuration
- `web/src/components/ui/*` - shadcn components
- `web/src/components/theme-provider.tsx` - Theme context
- `web/src/components/mode-toggle.tsx` - Theme toggle dropdown

## Decisions Made
[Any deviations or choices made]

## Issues Encountered
[Problems and resolutions, or "None"]

## Next Step
Ready for 06-03-PLAN.md (Layout & Routing)
</output>
