---
phase: 93-odds-comparison-page
plan: 02
type: execute
---

<objective>
Add resizable columns with localStorage persistence to the Odds Comparison table.

Purpose: Allow users to customize column widths for better readability, persisting preferences across sessions.
Output: Draggable column borders that resize columns, widths saved to localStorage.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@web/src/features/matches/components/match-table.tsx
@web/src/features/matches/hooks/use-column-settings.ts

**Established patterns:**
- useColumnSettings hook manages column visibility with localStorage (STORAGE_KEY = 'match-list-columns')
- Table uses static widths via className (e.g., `w-12`, `min-w-[2.5rem]`)

**Current table structure:**
- Fixed columns: Region, Tournament, Kickoff, Match, Book
- Market columns: 1X2, O/U 2.5, BTTS, DC (each with outcomes + margin)
- Market columns use colSpan for header grouping

**Resizing approach:**
- Store widths in localStorage as Record<string, number> (column ID -> width in px)
- Apply widths via inline styles
- Add resize handles between column headers
- Use mouse drag to resize
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create useColumnWidths hook for width persistence</name>
  <files>web/src/features/matches/hooks/use-column-widths.ts, web/src/features/matches/hooks/index.ts</files>
  <action>
Create a new hook for managing column widths with localStorage persistence:

```typescript
// Storage key separate from visibility settings
const STORAGE_KEY = 'match-list-column-widths'

// Default widths in pixels
const DEFAULT_WIDTHS: Record<string, number> = {
  region: 100,
  tournament: 150,
  kickoff: 120,
  match: 200,
  book: 50,
  // Market columns get dynamic widths based on outcomes
}

interface UseColumnWidthsReturn {
  widths: Record<string, number>
  setWidth: (columnId: string, width: number) => void
  resetWidths: () => void
}
```

The hook should:
1. Load widths from localStorage on mount
2. Provide setWidth function that updates state and localStorage
3. Provide resetWidths to restore defaults
4. Handle minimum width constraints (min 40px)

Export from hooks/index.ts.
  </action>
  <verify>
1. `npm run build` in web/ - no TypeScript errors
2. Hook exports correctly from index.ts
  </verify>
  <done>
useColumnWidths hook created with localStorage persistence, exported from hooks/index.ts
  </done>
</task>

<task type="auto">
  <name>Task 2: Add resize handles to MatchTable headers</name>
  <files>web/src/features/matches/components/match-table.tsx</files>
  <action>
Add resizable column functionality to the table:

1. Import useColumnWidths hook
2. Add resize handle component:
   - Render a 4px wide div at right edge of each resizable header cell
   - Style: cursor-col-resize, hover:bg-blue-500/50
   - Position: absolute right-0 top-0 bottom-0

3. Add resize logic:
   - onMouseDown on handle: start tracking mouse
   - onMouseMove (document): calculate width delta, call setWidth
   - onMouseUp (document): stop tracking
   - Use useRef to track startX and startWidth
   - Prevent text selection during drag

4. Apply widths from hook:
   - Use style={{ width: widths[columnId] }} on th elements
   - Fixed columns (region, tournament, kickoff, match, book) are resizable
   - Market columns (1X2, etc.) keep their colspan and auto-size

5. Add reset button to ColumnSettings dropdown:
   - "Reset widths" option that calls resetWidths()

Only fixed columns are resizable (Region, Tournament, Kickoff, Match, Book). Market columns retain their dynamic sizing based on content.
  </action>
  <verify>
1. `npm run build` in web/ - no errors
2. Start dev server, open Odds Comparison page
3. Hover over column borders shows resize cursor
4. Drag to resize columns
5. Refresh page - widths persist
6. Reset widths restores defaults
  </verify>
  <done>
Columns are resizable via drag, widths persist to localStorage, reset option available
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` in web/ succeeds without errors
- [ ] Column resize handles appear on hover
- [ ] Dragging resize handles changes column width
- [ ] Widths persist after page refresh
- [ ] Reset widths option works
- [ ] No visual regressions in table layout
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Column widths persist to localStorage
- Resize interaction is smooth and intuitive
  </success_criteria>

<output>
After completion, create `.planning/phases/93-odds-comparison-page/93-02-SUMMARY.md` with:
- Pattern: useColumnWidths hook for width persistence (separate from visibility)
- Pattern: Resize handle implementation (absolute positioned, mouse tracking)
</output>
