# 99.1-01-FIX2 Alerts Filter Latest Snapshot - Plan Summary

**One-liner:** Fixed alerts filter to query only LATEST snapshot per event, not all historical snapshots.

## Commits

| Task | Commit | Description |
|------|--------|-------------|
| Task 1 | f84906c | fix(99.1-01): query only LATEST snapshot for alerts filter |

## Files Modified

### Backend (src/)
- `src/api/routes/events.py` - Fixed get_alerts_count and list_events alerts filter to use latest snapshot subquery

## Root Cause

Both the `/api/events/alerts/count` endpoint and the `availability=alerts` filter were querying ALL historical OddsSnapshots instead of only the LATEST snapshot per event/bookmaker. This caused events that were temporarily unavailable in the past but are now available to still appear in the alerts list.

## Fix Applied

Added subqueries using `func.max(OddsSnapshot.id).label("max_id")` grouped by `event_id` to get only the latest snapshot, then join on that to check `unavailable_at`. This mirrors the pattern used in `_load_latest_snapshots_for_events`.

## Deviations

None.

## Performance

- Plan execution: ~5 minutes
- Single task completed without blockers

## Verification

- `npm run build` succeeds
- Ready for re-verification with /gsd:verify-work 99.1
