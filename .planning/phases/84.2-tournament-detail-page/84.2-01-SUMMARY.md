---
phase: 84.2-tournament-detail-page
plan: 01
subsystem: ui
tags: [react-router, tanstack-query, recharts, historical-analysis]

# Dependency graph
requires:
  - phase: 84.1-fix-tournament-metrics-design
    provides: Tournament list with View Details button target
provides:
  - Tournament detail route /historical-analysis/:tournamentId
  - useTournamentMarkets hook extracting ALL markets per tournament
  - TournamentDetailPage with market cards and timeline chart
affects: [85-time-to-kickoff-charts, 86-betpawa-vs-competitor]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - useTournamentMarkets hook for per-tournament market extraction
    - Market-level accumulator with id:line keys for unique market tracking

key-files:
  created:
    - web/src/features/historical-analysis/hooks/use-tournament-markets.ts
    - web/src/features/historical-analysis/tournament-detail.tsx
  modified:
    - web/src/routes.tsx
    - web/src/features/historical-analysis/components/tournament-list.tsx
    - web/src/features/historical-analysis/hooks/index.ts
    - web/src/features/historical-analysis/index.tsx

key-decisions:
  - "Extract ALL unique markets from Betpawa's inline_odds, not just TRACKED_MARKETS"
  - "Market key uses id:line combination for unique identification of markets with specifiers"
  - "Sort markets by eventCount descending to show most common markets first"

patterns-established:
  - "getMarketKey(id, line) pattern for unique market identification across specifier variants"
  - "TournamentMarket interface with marginHistory array for timeline visualization"

issues-created: []

# Metrics
duration: 8min
completed: 2026-02-10
---

# Phase 84.2 Plan 01: Tournament Detail Page Summary

**Tournament detail page with click-through navigation from list, ALL market cards with margin stats, and interactive timeline chart**

## Performance

- **Duration:** 8 min
- **Started:** 2026-02-10T10:00:00Z
- **Completed:** 2026-02-10T10:08:00Z
- **Tasks:** 2
- **Files modified:** 6

## Accomplishments

- Added `/historical-analysis/:tournamentId` route for tournament drill-down
- Created "View Details" button on TournamentCards with navigation
- Built useTournamentMarkets hook that extracts ALL unique markets (not just 4 tracked)
- Computes per-market avg/min/max margin and event count
- TournamentDetailPage with 3-column responsive grid of MarketCards
- Clicking a market card reveals MarginLineChart timeline below
- Search filter with fuzzy matching for market names
- Loading skeletons, error state, empty state, and back navigation

## Task Commits

1. **Task 1: Route, Navigation, and Data Hook** - `0f18646` (feat)
2. **Task 2: Tournament Detail Page with Market Cards and Timeline** - `ff9a60c` (feat)

## Files Created/Modified

- `web/src/routes.tsx` - Added /historical-analysis/:tournamentId route
- `web/src/features/historical-analysis/components/tournament-list.tsx` - Added View Details button with navigation
- `web/src/features/historical-analysis/hooks/use-tournament-markets.ts` - New hook for per-tournament market data
- `web/src/features/historical-analysis/hooks/index.ts` - Export new hook and types
- `web/src/features/historical-analysis/tournament-detail.tsx` - Full tournament detail page component
- `web/src/features/historical-analysis/index.tsx` - Export TournamentDetailPage

## Decisions Made

- Extract ALL unique markets from Betpawa's inline_odds rather than limiting to TRACKED_MARKETS - allows full visibility into any market type in the tournament
- Use id:line combination as market key to distinguish Over 2.5 from Over 1.5 etc.
- Sort markets by eventCount descending so most common markets appear first
- Default to 30-day date range for useTournamentMarkets hook

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None

## Next Phase Readiness

Ready for Phase 85: Time-to-Kickoff Charts - the tournament detail page now provides the foundation for adding time-based aggregation and visualization features.

---
*Phase: 84.2-tournament-detail-page*
*Completed: 2026-02-10*
