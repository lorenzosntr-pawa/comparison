---
phase: 51-navigation-ux
plan: 01
type: execute
---

<objective>
Add sticky navigation and quick-scroll features to the market grid for improved UX when browsing long market lists.

Purpose: Users can access tab filtering and search at any scroll position, reducing friction when exploring markets.
Output: Sticky tabs/filters that remain visible while scrolling, plus scroll-to-top for quick navigation.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context:
@.planning/phases/50-market-filtering/50-01-SUMMARY.md

# Key files:
@web/src/features/matches/index.tsx
@web/src/features/matches/components/market-grid.tsx
@web/src/features/matches/components/market-filter-bar.tsx

**Tech stack available:** React, Tailwind v4, shadcn/ui, lucide-react icons
**Established patterns:** useMemo for derived state, cn() for conditional classes
**Constraining decisions:** Betpawa always first column, tabs filter markets (not group into sections)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create sticky navigation container</name>
  <files>web/src/features/matches/components/market-grid.tsx</files>
  <action>
Wrap MarketTabs and MarketFilterBar in a sticky container:

1. Create a wrapper div around both components with classes:
   - `sticky top-0 z-10 bg-background pt-2 -mx-6 px-6` (negative margin to extend to card edges, padding to restore)
   - Add `pb-2 border-b` for visual separation from table content

2. The sticky container should contain:
   - MarketTabs component
   - MarketFilterBar component

3. Important: The Card containing MarketGrid uses CardContent which has padding. Use negative horizontal margin (-mx-6) to extend the sticky background to card edges, then restore with padding (px-6). This prevents content from showing through at the edges during scroll.

4. Add a subtle bottom border (border-b border-border) to visually separate the sticky header from scrolling content.

Avoid: Don't use fixed positioning - it would remove the element from document flow. Sticky is correct because it stays in flow until scroll threshold.
  </action>
  <verify>npm run build succeeds; manually scroll market table and verify tabs/filters remain visible at top</verify>
  <done>Tabs and filter bar stay visible when scrolling down through market rows; no visual bleed-through at edges</done>
</task>

<task type="auto">
  <name>Task 2: Add scroll-to-top button</name>
  <files>web/src/features/matches/components/market-grid.tsx</files>
  <action>
Add a floating scroll-to-top button that appears when user scrolls down:

1. Add state to track if user has scrolled: `const [showScrollTop, setShowScrollTop] = useState(false)`

2. Add useEffect with scroll listener on window:
   ```typescript
   useEffect(() => {
     const handleScroll = () => {
       setShowScrollTop(window.scrollY > 400)
     }
     window.addEventListener('scroll', handleScroll, { passive: true })
     return () => window.removeEventListener('scroll', handleScroll)
   }, [])
   ```

3. Create scroll-to-top handler:
   ```typescript
   const scrollToTop = () => {
     window.scrollTo({ top: 0, behavior: 'smooth' })
   }
   ```

4. Add button at end of component (after table), positioned fixed bottom-right:
   - Use Button from shadcn with variant="outline" and size="icon"
   - Icon: ArrowUp from lucide-react
   - Classes: `fixed bottom-6 right-6 shadow-lg transition-opacity duration-200`
   - Conditionally show: `{showScrollTop && <Button ... />}` or use opacity classes

5. Add aria-label="Scroll to top" for accessibility.

Avoid: Don't use scroll-margin or scroll-padding - simple scrollTo(0) is sufficient for this use case.
  </action>
  <verify>npm run build succeeds; scroll down and verify button appears; click button and verify smooth scroll to top</verify>
  <done>Floating button appears after scrolling 400px down; clicking smoothly scrolls to top; button hidden when near top</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Sticky tab/filter navigation and scroll-to-top button for market grid</what-built>
  <how-to-verify>
    1. Run: npm run dev (from web/ directory)
    2. Visit: http://localhost:5173/matches (or port shown)
    3. Click any match to view event details
    4. Scroll down through the market list
    5. Verify: Tabs and search/competitor filter remain visible at top
    6. Verify: Sticky header has visual separation (border) from content
    7. Verify: Floating "scroll to top" button appears when scrolled down
    8. Click the scroll-to-top button
    9. Verify: Page smoothly scrolls to top, button disappears
    10. Test on narrower viewport (resize browser) - sticky should work at all widths
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` in web/ succeeds without errors
- [ ] Tabs stay sticky when scrolling market table
- [ ] Filter bar stays sticky with tabs
- [ ] No visual bleed-through at sticky header edges
- [ ] Scroll-to-top button appears after scrolling
- [ ] Scroll-to-top smoothly returns to top
- [ ] Works on different viewport widths
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors or build warnings
- Sticky navigation improves market browsing UX
</success_criteria>

<output>
After completion, create `.planning/phases/51-navigation-ux/51-01-SUMMARY.md`:

# Phase 51 Plan 01: Sticky Navigation Summary

**[Substantive one-liner describing what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

[Ready for Phase 52 or describe blockers]
</output>
