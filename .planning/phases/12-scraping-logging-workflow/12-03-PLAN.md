---
phase: 14-scraping-logging-workflow
plan: 03
type: execute
---

<objective>
Redesign dashboard to remove Quick Actions widget and expand Recent Scrape Runs widget with richer per-run information.

Purpose: Provide at-a-glance visibility into scrape status with per-platform icons, live step info, and error summaries.
Output: Full-width scrape runs widget with enhanced row display, Quick Actions removed.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-scraping-logging-workflow/14-CONTEXT.md

# Key source files:
@web/src/features/dashboard/index.tsx
@web/src/features/dashboard/components/recent-runs.tsx
@web/src/features/dashboard/components/quick-actions.tsx

# Prior plans in this phase:
@.planning/phases/14-scraping-logging-workflow/14-01-SUMMARY.md
@.planning/phases/14-scraping-logging-workflow/14-02-SUMMARY.md

**UI vision from CONTEXT.md:**
- Remove Quick Actions widget
- Make Recent Scrape Runs full page width
- Show 5-6 runs with rich row info: status, timing, per-platform status icons, live step info for active runs, error summary for failed runs
- Click navigates to detail page

**Established patterns:**
- Static Tailwind class lookup (PLATFORM_PROGRESS_COLORS)
- TanStack Query polling: 10s for scheduler data
- SSE EventSource for real-time progress
- Badge component for status display
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove Quick Actions and restructure dashboard grid</name>
  <files>web/src/features/dashboard/index.tsx, web/src/features/dashboard/components/quick-actions.tsx</files>
  <action>
1. Update web/src/features/dashboard/index.tsx:
   - Remove QuickActions import
   - Remove QuickActions component from JSX
   - Change grid layout from 2-column to single column for scrape runs section
   - Keep other dashboard widgets (stats, health, etc.) in their original positions
   - Make RecentRuns span full width

2. Delete web/src/features/dashboard/components/quick-actions.tsx (no longer needed)

3. Update any index.ts re-exports if QuickActions was exported

Layout should be:
- Top row: Stats cards (existing)
- Second row: Full-width Recent Scrape Runs (enhanced)
- Remaining rows: Other widgets as before (health, etc.)

Do NOT change the stats cards or health widget layouts.
  </action>
  <verify>Check that dashboard loads without QuickActions: open browser to http://localhost:5173</verify>
  <done>Quick Actions removed, Recent Scrape Runs is full width, dashboard grid restructured</done>
</task>

<task type="auto">
  <name>Task 2: Enhance scrape run rows with per-platform icons and live info</name>
  <files>web/src/features/dashboard/components/recent-runs.tsx, web/src/features/dashboard/hooks/use-scheduler-status.ts</files>
  <action>
1. Update useSchedulerHistory hook (or its data source) to include:
   - platform_status from backend (e.g., {"betpawa": "completed", "sportybet": "active", "bet9ja": "pending"})
   - current_phase and current_platform for running scrapes
   - Error count or brief error message for failed/partial runs

2. Create PlatformStatusIcon component in recent-runs.tsx:
```tsx
const PLATFORM_STATUS_ICONS: Record<string, { icon: LucideIcon; color: string }> = {
  pending: { icon: Circle, color: 'text-muted-foreground' },
  active: { icon: Loader2, color: 'text-blue-500' },
  completed: { icon: CheckCircle2, color: 'text-green-500' },
  failed: { icon: XCircle, color: 'text-destructive' },
}

function PlatformStatusIcon({ platform, status }: { platform: string; status: string }) {
  const { icon: Icon, color } = PLATFORM_STATUS_ICONS[status] || PLATFORM_STATUS_ICONS.pending
  return (
    <div className="flex items-center gap-1" title={`${platform}: ${status}`}>
      <Icon className={cn('h-3 w-3', color, status === 'active' && 'animate-spin')} />
      <span className="text-xs capitalize">{platform.slice(0, 3)}</span>
    </div>
  )
}
```

3. Enhance run row display in RecentRuns component:
   - Show per-platform status icons in a row: [BP ✓] [SB ⟳] [B9 ○]
   - For active runs: show current operation text (e.g., "SportyBet: scraping...")
   - For failed/partial runs: show error count badge (e.g., "2 errors")
   - Make entire row clickable to navigate to detail page (wrap in Link)
   - Increase default display to 6 runs (was 5)

4. Update live progress section:
   - Show which platform is currently active with its icon
   - Show current phase (scraping, storing, etc.) alongside platform name

5. Add error summary for failed runs:
```tsx
{run.errors_count > 0 && (
  <Badge variant="destructive" className="text-xs">
    {run.errors_count} error{run.errors_count !== 1 ? 's' : ''}
  </Badge>
)}
```

Platform icon colors:
- betpawa: green-500
- sportybet: blue-500
- bet9ja: orange-500

Do NOT break existing SSE streaming functionality.
Keep the "Start New Scrape" button functional.
  </action>
  <verify>Start dev server and verify: dashboard shows enhanced run rows, platform icons visible, rows are clickable</verify>
  <done>Run rows show per-platform status icons, live step info for active runs, error summaries, clickable to detail page</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Redesigned dashboard with full-width scrape runs widget and enhanced row information</what-built>
  <how-to-verify>
    1. Run: `cd web && pnpm dev` (frontend) and `uvicorn src.main:app --reload` (backend)
    2. Visit: http://localhost:5173
    3. Verify: Quick Actions widget is GONE
    4. Verify: Recent Scrape Runs widget spans full width
    5. Verify: Each run row shows per-platform status icons (BP, SB, B9 with status colors)
    6. Trigger a scrape (click "Start New Scrape")
    7. Verify: During scrape, see which platform is currently active with spinner
    8. Verify: After completion, all platform icons show checkmarks (if successful)
    9. Click on a run row
    10. Verify: Navigates to /scrape-runs/{id} detail page
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Dashboard loads without errors
- [ ] Quick Actions widget removed
- [ ] Recent Scrape Runs is full width
- [ ] Run rows show per-platform status icons
- [ ] Active runs show current operation
- [ ] Failed runs show error count
- [ ] Rows are clickable and navigate to detail page
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Human verified dashboard changes look correct
- Quick Actions removed
- Full-width scrape runs with richer row information
- Per-platform status icons visible
- Clickable rows navigate to detail
</success_criteria>

<output>
After completion, create `.planning/phases/14-scraping-logging-workflow/14-03-SUMMARY.md`
</output>
