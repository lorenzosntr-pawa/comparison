---
phase: 83-historical-analysis-page
plan: 01
type: execute
domain: react
---

<objective>
Create Historical Analysis page foundation with route, navigation, filter bar, and tournament list.

Purpose: Establish the dedicated page for analyzing historical margin patterns across tournaments.
Output: New `/historical-analysis` route with page shell, date range filter, and tournament list.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context:
@.planning/phases/82-comparison-table/82-01-SUMMARY.md

# Established patterns:
@web/src/routes.tsx
@web/src/components/layout/app-sidebar.tsx
@web/src/features/matches/index.tsx
@web/src/features/matches/components/match-filters.tsx

# Existing UI components:
Uses shadcn/ui components (Button, Card, DatePicker via calendar)

**Key patterns:**
- Feature folders: components/, hooks/, lib/, index.tsx
- Routes: Named exports in routes.tsx with React Router
- Navigation: navItems array in app-sidebar.tsx with Lucide icons
- Filter bar: MatchFilters pattern - inline filters with state managed in parent

**Constraints:**
- Use existing shadcn calendar component (already in codebase)
- Tournament data comes from existing events API (filter unique tournaments)
- Page is foundation only - metrics/charts come in later phases
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create feature structure, route, and navigation</name>
  <files>
    web/src/features/historical-analysis/index.tsx,
    web/src/features/historical-analysis/components/index.ts,
    web/src/routes.tsx,
    web/src/components/layout/app-sidebar.tsx
  </files>
  <action>
    1. Create `web/src/features/historical-analysis/` folder structure:
       - `index.tsx` - exports HistoricalAnalysisPage component
       - `components/index.ts` - barrel export (empty for now)

    2. Create basic HistoricalAnalysisPage component:
       - Page title "Historical Analysis"
       - Placeholder text "Tournament analysis coming in Phase 84"
       - Uses Card from shadcn for layout

    3. Add route in `routes.tsx`:
       - Import HistoricalAnalysisPage from '@/features/historical-analysis'
       - Add `<Route path="/historical-analysis" element={<HistoricalAnalysisPage />} />`

    4. Add navigation in `app-sidebar.tsx`:
       - Import TrendingUp from lucide-react
       - Add `{ title: 'Historical Analysis', url: '/historical-analysis', icon: TrendingUp }` to navItems
       - Place after "Coverage" in the navigation order
  </action>
  <verify>
    - `npm run build` succeeds
    - Navigate to /historical-analysis in browser shows page title
    - Sidebar shows "Historical Analysis" link with icon
  </verify>
  <done>Route accessible, navigation visible, basic page shell renders</done>
</task>

<task type="auto">
  <name>Task 2: Add filter bar with date range picker</name>
  <files>
    web/src/features/historical-analysis/components/filter-bar.tsx,
    web/src/features/historical-analysis/components/index.ts,
    web/src/features/historical-analysis/index.tsx
  </files>
  <action>
    1. Create FilterBar component in `components/filter-bar.tsx`:
       - Props: dateRange (from/to as Date | undefined), onDateRangeChange callback
       - Two DatePicker buttons: "From" and "To" using shadcn Popover + Calendar
       - Default "From" to 7 days ago, "To" to today
       - Display format: "MMM d, yyyy" (e.g., "Feb 3, 2026")
       - Quick preset buttons: "Last 7 days", "Last 30 days", "Last 90 days"
       - Use existing Button, Popover, Calendar components from @/components/ui

    2. Import date-fns for date manipulation (subDays, format) - already in dependencies

    3. Update components/index.ts to export FilterBar

    4. Integrate FilterBar in index.tsx:
       - Add state for dateRange: { from?: Date, to?: Date }
       - Pass to FilterBar and handle changes
       - Display selected range summary below filter bar
  </action>
  <verify>
    - DatePickers open calendar popover when clicked
    - Selecting dates updates the displayed range
    - Quick preset buttons set correct date ranges
  </verify>
  <done>Filter bar renders with working date range picker and presets</done>
</task>

<task type="auto">
  <name>Task 3: Add tournament list component</name>
  <files>
    web/src/features/historical-analysis/components/tournament-list.tsx,
    web/src/features/historical-analysis/hooks/use-tournaments.ts,
    web/src/features/historical-analysis/hooks/index.ts,
    web/src/features/historical-analysis/components/index.ts,
    web/src/features/historical-analysis/index.tsx
  </files>
  <action>
    1. Create hooks/use-tournaments.ts:
       - Use existing events API endpoint GET /api/events
       - Query with kickoffFrom/kickoffTo from filter bar date range
       - Extract unique tournaments from events: { id, name, country, eventCount }
       - Return { tournaments, isLoading, error }
       - Use TanStack Query with key ["tournaments", dateRange.from, dateRange.to]

    2. Create hooks/index.ts barrel export

    3. Create TournamentList component in components/tournament-list.tsx:
       - Props: tournaments array, isLoading boolean
       - Display as Card grid (responsive: 1 col mobile, 2 cols md, 3 cols lg)
       - Each card shows: tournament name, country flag emoji/text, event count badge
       - Loading state: Skeleton cards
       - Empty state: "No tournaments with data in selected period"
       - Cards are clickable (prepare for Phase 84 drill-down, onClick placeholder for now)

    4. Update components/index.ts to export TournamentList

    5. Integrate in index.tsx:
       - Call useTournaments hook with dateRange
       - Render TournamentList below filter bar
       - Pass loading state for skeleton display
  </action>
  <verify>
    - `npm run build` succeeds
    - Page shows loading skeletons initially
    - Tournaments load and display as cards with names, countries, event counts
    - Changing date range refreshes the tournament list
  </verify>
  <done>Tournament list displays with data from API, responsive grid layout, loading states</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Route /historical-analysis loads the page
- [ ] Sidebar navigation shows "Historical Analysis" with TrendingUp icon
- [ ] Date range filter works with calendar pickers
- [ ] Quick preset buttons work (7d, 30d, 90d)
- [ ] Tournament list loads from API
- [ ] Responsive grid layout on different screen sizes
- [ ] Loading and empty states display correctly
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Page foundation ready for Phase 84 metrics
</success_criteria>

<output>
After completion, create `.planning/phases/83-historical-analysis-page/83-01-SUMMARY.md`:

# Phase 83 Plan 01: Historical Analysis Page Foundation Summary

**[One-liner about what shipped]**

## Accomplishments

- [Key outcomes]

## Files Created/Modified

- [File list with descriptions]

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

- Phase 83 complete with 1/1 plans finished
- Ready for Phase 84: Tournament Summary Metrics
</output>
